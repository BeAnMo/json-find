var JsonFind=function(){"use strict";function t(t,e){let n=t,o=0;for(;void 0!==e[o]&&(n=n[e[o]],void 0!==n);)o++;return n}function e(t,e,n){let o=t,i=0;for(;void 0!==e[i+1];){const t=e[i];o=void 0===o[t]?o[t]=isNaN(e[i+1])?{}:[]:o[t],i++}return o[e[i]]=n,o}function n(t){return Array.isArray(t)}function o(t){return n(t)||function(t){return"object"==typeof t&&!n(t)&&null!==t}(t)}function i(t,e="."){return t.split(e)}function r(t,e){this.delimiter=e,n(t)?this.path=t:this.path=t.split(this.delimiter)}function s(t,e){this.doc=t,this.delim=e,this.q=[],this.setQueue(new r([],this.delim),Object.keys(this.doc))}function u(t,e={}){if(!o(t))throw new Error("Instantiating JsonFind requires an Object or an Array.");this.options={delimeter:e.delimeter||".",useConstructor:e.useConstructor||!1},this.doc=t}return r.prototype.toString=function(){return this.path.join(this.delimiter)},r.prototype.toArray=function(){return this.path},r.prototype.clone=function(){return new r([...this.path],this.delimiter)},r.prototype.slice=function(t,e){return new r(this.path.slice(t,e),this.delimiter)},r.prototype.append=function(t){return this.path.push(t),this},s.prototype.setQueue=function(t,e){return e.forEach((e=>{const n=t.clone().append(e);this.q.push(n)})),this},s.prototype.next=function(){const e=this.q.shift(),n=t(this.doc,e.toArray());return o(n)?(this.setQueue(e,Object.keys(n)),this.next()):{path:e,value:n,key:e.slice(-1).toString()}},s.prototype.empty=function(){return 0===this.q.length},u.prototype.get=function(e,n={}){const r=n.useConstructor||this.options.useConstructor,s=i(e,this.options.delimeter),c=t(this.doc,s);return r&&o(c)?new u(c,this.options):c},u.prototype.set=function(t,n){const o=i(t,this.options.delimeter);return e(this.doc,o,n),this},u.prototype.dump=function(){return this.doc},u.prototype.each=function(t){const e=new s(this.doc,this.options.delimeter);for(;!e.empty();)t.call(this,e.next())},u.prototype.transform=function(t){const e=new s(this.doc,this.options.delimeter),n=new u(u.getBase(this.doc),this.options);for(;!e.empty();){const o=e.next();n.set(o.path.toArray(),t.call(this,o))}return n},u.prototype.prune=function(t){const e=new s(this.doc,this.options.delimeter),n=new u(u.getBase(this.doc),this.options);for(;!e.empty();){const o=e.next();t.call(this,o)&&n.set(o.path.toString(),o.value)}return n},u.getBase=function(t){return n(t)?[]:{}},u.clone=function(t,n){const o=new s(t,n&&n.delimeter||".");let i=u.getBase(t);for(;!o.empty();){const t=o.next();e(i,t.path.toArray(),t.value)}return i},u}();
