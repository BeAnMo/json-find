"use strict";function t(){this.q=[],this.L=0}function e(t){return Array.isArray(t)}function o(t){return e(t)||function(t){return"object"==typeof t&&!e(t)&&null!==t}(t)}function n(t,e="."){return t.split(e)}function s(e){this.docInstance=e,this.delim=e.options.delimeter,this.q=new t,this.setQueue("",Object.keys(e.doc))}function i(t,e={}){this.options={delimeter:e.delimeter||".",useConstructor:e.useConstructor||!1},this.doc=t}t.prototype.push=function(t){return this.L=this.q.push(t),this},t.prototype.pop=function(){const[t,...e]=this.q;return this.q=e,this.L>0&&(this.L-=1),t},t.prototype.empty=function(){return 0===this.L},s.prototype.setQueue=function(t,e){return e.forEach((e=>{const o=`${t}${e}`;this.q.push(o)})),this},s.prototype.getCurrentKey=function(t){return(e=n(t,this.delim))[e.length-1];var e},s.prototype.getAtPath=function(t){return this.docInstance.getAt(t,{noInstance:!0})},s.prototype.next=function(){const t=this.q.pop(),e=this.getAtPath(t);return o(e)?(this.setQueue(`${t}${this.delim}`,Object.keys(e)),this.next()):{path:t,value:e,key:this.getCurrentKey(t)}},s.prototype.empty=function(){return this.q.empty()},i.prototype.getAt=function(t,e={}){const s=e.useConstructor||this.options.useConstructor,r=n(t,this.options.delimeter);let u=this.doc,c=0;for(;void 0!==r[c]&&(u=u[r[c]],void 0!==u);)c++;return o(u)&&s?new i(u,this.options):u},i.prototype.setAt=function(t,e){const o=n(t,this.options.delimeter);let s=this.doc,i=0;for(;void 0!==o[i+1];){const t=o[i];s=void 0===s[t]?s[t]=isNaN(o[i+1])?{}:[]:s[t],i++}return s[o[i]]=e,this},i.prototype.each=function(t){const e=new s(this);for(;!e.empty();)t.call(this,e.next())},i.prototype.prune=function(t){const e=new s(this),o=new i({},this.options);for(;!e.empty();){const n=e.next();t.call(this,n)&&o.setAt(n.path,n.value)}return o},module.exports=i;
